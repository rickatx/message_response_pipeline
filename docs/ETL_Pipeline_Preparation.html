---

title: Disaster Response ETL Pipeline


keywords: fastai
sidebar: home_sidebar

summary: "Perform ETL on categorized message data."
description: "Perform ETL on categorized message data."
nb_path: "notebooks/ETL_Pipeline_Preparation.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: notebooks\ETL_Pipeline_Preparation.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The goal of the disaster response project is to process and flag (categorize) messages received during a disaster response.</p>
<p>This notebook contains code to perform ETL on raw message data to be used for training. It consists of 2 parts:</p>
<ol>
<li>Interactive development of an ETL pipeline</li>
<li>Code cells to test and generate a Python script to perform the ETL developed in the first part in production. <em>Python script generation is done using <a href="https://github.com/fastai/nbdev">nbdev</a></em>.</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Interactive-Development">Interactive Development<a class="anchor-link" href="#Interactive-Development"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="1.-Import-libraries-and-load-datasets.">1. Import libraries and load datasets.<a class="anchor-link" href="#1.-Import-libraries-and-load-datasets."> </a></h3><ul>
<li>Import Python libraries</li>
<li>Load <code>messages.csv</code> into a dataframe and inspect the first few lines.</li>
<li>Load <code>categories.csv</code> into a dataframe and inspect the first few lines.</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">create_engine</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s1">&#39;../data&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">messages</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;messages.csv&quot;</span><span class="p">)</span>
<span class="n">messages</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>message</th>
      <th>original</th>
      <th>genre</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>Weather update - a cold front from Cuba that c...</td>
      <td>Un front froid se retrouve sur Cuba ce matin. ...</td>
      <td>direct</td>
    </tr>
    <tr>
      <th>1</th>
      <td>7</td>
      <td>Is the Hurricane over or is it not over</td>
      <td>Cyclone nan fini osinon li pa fini</td>
      <td>direct</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8</td>
      <td>Looking for someone but no name</td>
      <td>Patnm, di Maryani relem pou li banm nouvel li ...</td>
      <td>direct</td>
    </tr>
    <tr>
      <th>3</th>
      <td>9</td>
      <td>UN reports Leogane 80-90 destroyed. Only Hospi...</td>
      <td>UN reports Leogane 80-90 destroyed. Only Hospi...</td>
      <td>direct</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12</td>
      <td>says: west side of Haiti, rest of the country ...</td>
      <td>facade ouest d Haiti et le reste du pays aujou...</td>
      <td>direct</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">messages</span><span class="o">.</span><span class="n">genre</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>news      13068
direct    10782
social     2398
Name: genre, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">categories</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;categories.csv&quot;</span><span class="p">)</span>
<span class="n">categories</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>categories</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>related-1;request-0;offer-0;aid_related-0;medi...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>7</td>
      <td>related-1;request-0;offer-0;aid_related-1;medi...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8</td>
      <td>related-1;request-0;offer-0;aid_related-0;medi...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>9</td>
      <td>related-1;request-1;offer-0;aid_related-1;medi...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12</td>
      <td>related-1;request-0;offer-0;aid_related-0;medi...</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="2.-Merge-datasets.">2. Merge datasets.<a class="anchor-link" href="#2.-Merge-datasets."> </a></h3><ul>
<li>Merge the messages and categories datasets using the common id</li>
<li>Assign this combined dataset to <code>df</code>, which will be cleaned in the following steps</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Before merging, are the ids in each dataset unique?</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">dup_counts</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">cols</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Find duplicate rows in `df`, considering the columns with names in the list &#39;cols`.</span>
<span class="sd">    </span>
<span class="sd">    Return:</span>
<span class="sd">     - A dataframe containing the values of `cols` for which there are multiple rows, and </span>
<span class="sd">     the multiple row count in column &#39;count&#39;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">df_gb</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">:</span><span class="s1">&#39;count&#39;</span><span class="p">})</span>
    <span class="n">df_dups</span> <span class="o">=</span> <span class="n">df_gb</span><span class="p">[</span><span class="n">df_gb</span><span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">df_dups</span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">(</span><span class="n">dup_counts</span><span class="p">(</span><span class="n">messages</span><span class="p">,</span> <span class="s1">&#39;id&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
 <span class="n">dup_counts</span><span class="p">(</span><span class="n">messages</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;message&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
 <span class="n">dup_counts</span><span class="p">(</span><span class="n">messages</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;message&#39;</span><span class="p">,</span> <span class="s1">&#39;genre&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(67, 67, 67)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dup_counts</span><span class="p">(</span><span class="n">messages</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;message&#39;</span><span class="p">,</span> <span class="s1">&#39;original&#39;</span><span class="p">,</span> <span class="s1">&#39;genre&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>31</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In <code>messages</code>, there are 67 rows with the same values for columns 'id', 'message', 'genre'. The number of duplicates drops to 31 if we also consider the <code>original</code> column.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dup_counts</span><span class="p">(</span><span class="n">categories</span><span class="p">,</span> <span class="s1">&#39;id&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>67</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dup_counts</span><span class="p">(</span><span class="n">categories</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">categories</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>31</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">categories</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">messages</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(26248, 26248)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Since the duplicate counts for <code>categories</code> matches those for <code>messages</code>, it appears that these two dataframes were split from one another for the purpose of this exercise.</p>
<p>We have no way of knowing which of the categorizations for a given message are more accurate, so for now we will retain all this data. After the join of <code>messages</code> and <code>categories</code>, we can remove any duplicates. This will still allow the possibility that the training data will have multiple training instances for a given message, with differing categorizations. Each of the provided classifications will contribute to the training.</p>
<p>If it were possible to redesign the categorization process, it would make sense to ensure that the <code>messages</code> data does not contain duplicates before generating categorizations.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">messages</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">categories</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;id&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>message</th>
      <th>original</th>
      <th>genre</th>
      <th>categories</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>Weather update - a cold front from Cuba that c...</td>
      <td>Un front froid se retrouve sur Cuba ce matin. ...</td>
      <td>direct</td>
      <td>related-1;request-0;offer-0;aid_related-0;medi...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>7</td>
      <td>Is the Hurricane over or is it not over</td>
      <td>Cyclone nan fini osinon li pa fini</td>
      <td>direct</td>
      <td>related-1;request-0;offer-0;aid_related-1;medi...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8</td>
      <td>Looking for someone but no name</td>
      <td>Patnm, di Maryani relem pou li banm nouvel li ...</td>
      <td>direct</td>
      <td>related-1;request-0;offer-0;aid_related-0;medi...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>9</td>
      <td>UN reports Leogane 80-90 destroyed. Only Hospi...</td>
      <td>UN reports Leogane 80-90 destroyed. Only Hospi...</td>
      <td>direct</td>
      <td>related-1;request-1;offer-0;aid_related-1;medi...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12</td>
      <td>says: west side of Haiti, rest of the country ...</td>
      <td>facade ouest d Haiti et le reste du pays aujou...</td>
      <td>direct</td>
      <td>related-1;request-0;offer-0;aid_related-0;medi...</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="3.-Split-categories-into-separate-category-columns.">3. Split <code>categories</code> into separate category columns.<a class="anchor-link" href="#3.-Split-categories-into-separate-category-columns."> </a></h3><ul>
<li>Split the values in the <code>categories</code> column on the <code>;</code> character so that each value becomes a separate column. You'll find <a href="https://pandas.pydata.org/pandas-docs/version/0.23/generated/pandas.Series.str.split.html">this method</a> very helpful! Make sure to set <code>expand=True</code>.</li>
<li>Use the first row of categories dataframe to create column names for the categories data.</li>
<li>Rename columns of <code>categories</code> with new column names.</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">categories</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">categories</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">categories</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>...</th>
      <th>26</th>
      <th>27</th>
      <th>28</th>
      <th>29</th>
      <th>30</th>
      <th>31</th>
      <th>32</th>
      <th>33</th>
      <th>34</th>
      <th>35</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>related-1</td>
      <td>request-0</td>
      <td>offer-0</td>
      <td>aid_related-0</td>
      <td>medical_help-0</td>
      <td>medical_products-0</td>
      <td>search_and_rescue-0</td>
      <td>security-0</td>
      <td>military-0</td>
      <td>child_alone-0</td>
      <td>...</td>
      <td>aid_centers-0</td>
      <td>other_infrastructure-0</td>
      <td>weather_related-0</td>
      <td>floods-0</td>
      <td>storm-0</td>
      <td>fire-0</td>
      <td>earthquake-0</td>
      <td>cold-0</td>
      <td>other_weather-0</td>
      <td>direct_report-0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>related-1</td>
      <td>request-0</td>
      <td>offer-0</td>
      <td>aid_related-1</td>
      <td>medical_help-0</td>
      <td>medical_products-0</td>
      <td>search_and_rescue-0</td>
      <td>security-0</td>
      <td>military-0</td>
      <td>child_alone-0</td>
      <td>...</td>
      <td>aid_centers-0</td>
      <td>other_infrastructure-0</td>
      <td>weather_related-1</td>
      <td>floods-0</td>
      <td>storm-1</td>
      <td>fire-0</td>
      <td>earthquake-0</td>
      <td>cold-0</td>
      <td>other_weather-0</td>
      <td>direct_report-0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>related-1</td>
      <td>request-0</td>
      <td>offer-0</td>
      <td>aid_related-0</td>
      <td>medical_help-0</td>
      <td>medical_products-0</td>
      <td>search_and_rescue-0</td>
      <td>security-0</td>
      <td>military-0</td>
      <td>child_alone-0</td>
      <td>...</td>
      <td>aid_centers-0</td>
      <td>other_infrastructure-0</td>
      <td>weather_related-0</td>
      <td>floods-0</td>
      <td>storm-0</td>
      <td>fire-0</td>
      <td>earthquake-0</td>
      <td>cold-0</td>
      <td>other_weather-0</td>
      <td>direct_report-0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>related-1</td>
      <td>request-1</td>
      <td>offer-0</td>
      <td>aid_related-1</td>
      <td>medical_help-0</td>
      <td>medical_products-1</td>
      <td>search_and_rescue-0</td>
      <td>security-0</td>
      <td>military-0</td>
      <td>child_alone-0</td>
      <td>...</td>
      <td>aid_centers-0</td>
      <td>other_infrastructure-0</td>
      <td>weather_related-0</td>
      <td>floods-0</td>
      <td>storm-0</td>
      <td>fire-0</td>
      <td>earthquake-0</td>
      <td>cold-0</td>
      <td>other_weather-0</td>
      <td>direct_report-0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>related-1</td>
      <td>request-0</td>
      <td>offer-0</td>
      <td>aid_related-0</td>
      <td>medical_help-0</td>
      <td>medical_products-0</td>
      <td>search_and_rescue-0</td>
      <td>security-0</td>
      <td>military-0</td>
      <td>child_alone-0</td>
      <td>...</td>
      <td>aid_centers-0</td>
      <td>other_infrastructure-0</td>
      <td>weather_related-0</td>
      <td>floods-0</td>
      <td>storm-0</td>
      <td>fire-0</td>
      <td>earthquake-0</td>
      <td>cold-0</td>
      <td>other_weather-0</td>
      <td>direct_report-0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 36 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">row</span> <span class="o">=</span> <span class="n">categories</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># use this row to extract a list of new column names for categories.</span>
<span class="n">category_colnames</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">row</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">category_colnames</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[&#39;related&#39;, &#39;request&#39;, &#39;offer&#39;, &#39;aid_related&#39;, &#39;medical_help&#39;, &#39;medical_products&#39;, &#39;search_and_rescue&#39;, &#39;security&#39;, &#39;military&#39;, &#39;child_alone&#39;, &#39;water&#39;, &#39;food&#39;, &#39;shelter&#39;, &#39;clothing&#39;, &#39;money&#39;, &#39;missing_people&#39;, &#39;refugees&#39;, &#39;death&#39;, &#39;other_aid&#39;, &#39;infrastructure_related&#39;, &#39;transport&#39;, &#39;buildings&#39;, &#39;electricity&#39;, &#39;tools&#39;, &#39;hospitals&#39;, &#39;shops&#39;, &#39;aid_centers&#39;, &#39;other_infrastructure&#39;, &#39;weather_related&#39;, &#39;floods&#39;, &#39;storm&#39;, &#39;fire&#39;, &#39;earthquake&#39;, &#39;cold&#39;, &#39;other_weather&#39;, &#39;direct_report&#39;]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">categories</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">category_colnames</span>
<span class="n">categories</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>related</th>
      <th>request</th>
      <th>offer</th>
      <th>aid_related</th>
      <th>medical_help</th>
      <th>medical_products</th>
      <th>search_and_rescue</th>
      <th>security</th>
      <th>military</th>
      <th>child_alone</th>
      <th>...</th>
      <th>aid_centers</th>
      <th>other_infrastructure</th>
      <th>weather_related</th>
      <th>floods</th>
      <th>storm</th>
      <th>fire</th>
      <th>earthquake</th>
      <th>cold</th>
      <th>other_weather</th>
      <th>direct_report</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>related-1</td>
      <td>request-0</td>
      <td>offer-0</td>
      <td>aid_related-0</td>
      <td>medical_help-0</td>
      <td>medical_products-0</td>
      <td>search_and_rescue-0</td>
      <td>security-0</td>
      <td>military-0</td>
      <td>child_alone-0</td>
      <td>...</td>
      <td>aid_centers-0</td>
      <td>other_infrastructure-0</td>
      <td>weather_related-0</td>
      <td>floods-0</td>
      <td>storm-0</td>
      <td>fire-0</td>
      <td>earthquake-0</td>
      <td>cold-0</td>
      <td>other_weather-0</td>
      <td>direct_report-0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>related-1</td>
      <td>request-0</td>
      <td>offer-0</td>
      <td>aid_related-1</td>
      <td>medical_help-0</td>
      <td>medical_products-0</td>
      <td>search_and_rescue-0</td>
      <td>security-0</td>
      <td>military-0</td>
      <td>child_alone-0</td>
      <td>...</td>
      <td>aid_centers-0</td>
      <td>other_infrastructure-0</td>
      <td>weather_related-1</td>
      <td>floods-0</td>
      <td>storm-1</td>
      <td>fire-0</td>
      <td>earthquake-0</td>
      <td>cold-0</td>
      <td>other_weather-0</td>
      <td>direct_report-0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>related-1</td>
      <td>request-0</td>
      <td>offer-0</td>
      <td>aid_related-0</td>
      <td>medical_help-0</td>
      <td>medical_products-0</td>
      <td>search_and_rescue-0</td>
      <td>security-0</td>
      <td>military-0</td>
      <td>child_alone-0</td>
      <td>...</td>
      <td>aid_centers-0</td>
      <td>other_infrastructure-0</td>
      <td>weather_related-0</td>
      <td>floods-0</td>
      <td>storm-0</td>
      <td>fire-0</td>
      <td>earthquake-0</td>
      <td>cold-0</td>
      <td>other_weather-0</td>
      <td>direct_report-0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>related-1</td>
      <td>request-1</td>
      <td>offer-0</td>
      <td>aid_related-1</td>
      <td>medical_help-0</td>
      <td>medical_products-1</td>
      <td>search_and_rescue-0</td>
      <td>security-0</td>
      <td>military-0</td>
      <td>child_alone-0</td>
      <td>...</td>
      <td>aid_centers-0</td>
      <td>other_infrastructure-0</td>
      <td>weather_related-0</td>
      <td>floods-0</td>
      <td>storm-0</td>
      <td>fire-0</td>
      <td>earthquake-0</td>
      <td>cold-0</td>
      <td>other_weather-0</td>
      <td>direct_report-0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>related-1</td>
      <td>request-0</td>
      <td>offer-0</td>
      <td>aid_related-0</td>
      <td>medical_help-0</td>
      <td>medical_products-0</td>
      <td>search_and_rescue-0</td>
      <td>security-0</td>
      <td>military-0</td>
      <td>child_alone-0</td>
      <td>...</td>
      <td>aid_centers-0</td>
      <td>other_infrastructure-0</td>
      <td>weather_related-0</td>
      <td>floods-0</td>
      <td>storm-0</td>
      <td>fire-0</td>
      <td>earthquake-0</td>
      <td>cold-0</td>
      <td>other_weather-0</td>
      <td>direct_report-0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 36 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="4.-Convert-category-values-to-just-numbers-0-or-1.">4. Convert category values to just numbers 0 or 1.<a class="anchor-link" href="#4.-Convert-category-values-to-just-numbers-0-or-1."> </a></h3><ul>
<li>Iterate through the category columns in df to keep only the last character of each string (the 1 or 0). For example, <code>related-0</code> becomes <code>0</code>, <code>related-1</code> becomes <code>1</code>. Convert the string to a numeric value.</li>
<li>You can perform <a href="https://pandas.pydata.org/pandas-docs/stable/text.html#indexing-with-str">normal string actions on Pandas Series</a>, like indexing, by including <code>.str</code> after the Series. </li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">categories</span><span class="p">:</span>
    <span class="c1"># set each value to be the last character of the string</span>
    <span class="n">categories</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">categories</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    
    <span class="c1"># convert column from string to numeric</span>
    <span class="n">categories</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">categories</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">categories</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>related</th>
      <th>request</th>
      <th>offer</th>
      <th>aid_related</th>
      <th>medical_help</th>
      <th>medical_products</th>
      <th>search_and_rescue</th>
      <th>security</th>
      <th>military</th>
      <th>child_alone</th>
      <th>...</th>
      <th>aid_centers</th>
      <th>other_infrastructure</th>
      <th>weather_related</th>
      <th>floods</th>
      <th>storm</th>
      <th>fire</th>
      <th>earthquake</th>
      <th>cold</th>
      <th>other_weather</th>
      <th>direct_report</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 36 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="5.-Replace-categories-column-in-df-with-new-category-columns.">5. Replace <code>categories</code> column in <code>df</code> with new category columns.<a class="anchor-link" href="#5.-Replace-categories-column-in-df-with-new-category-columns."> </a></h3><ul>
<li>Drop the categories column from the df dataframe since it is no longer needed.</li>
<li>Concatenate df and categories data frames.</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;categories&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>message</th>
      <th>original</th>
      <th>genre</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>Weather update - a cold front from Cuba that c...</td>
      <td>Un front froid se retrouve sur Cuba ce matin. ...</td>
      <td>direct</td>
    </tr>
    <tr>
      <th>1</th>
      <td>7</td>
      <td>Is the Hurricane over or is it not over</td>
      <td>Cyclone nan fini osinon li pa fini</td>
      <td>direct</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8</td>
      <td>Looking for someone but no name</td>
      <td>Patnm, di Maryani relem pou li banm nouvel li ...</td>
      <td>direct</td>
    </tr>
    <tr>
      <th>3</th>
      <td>9</td>
      <td>UN reports Leogane 80-90 destroyed. Only Hospi...</td>
      <td>UN reports Leogane 80-90 destroyed. Only Hospi...</td>
      <td>direct</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12</td>
      <td>says: west side of Haiti, rest of the country ...</td>
      <td>facade ouest d Haiti et le reste du pays aujou...</td>
      <td>direct</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">categories</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>message</th>
      <th>original</th>
      <th>genre</th>
      <th>related</th>
      <th>request</th>
      <th>offer</th>
      <th>aid_related</th>
      <th>medical_help</th>
      <th>medical_products</th>
      <th>...</th>
      <th>aid_centers</th>
      <th>other_infrastructure</th>
      <th>weather_related</th>
      <th>floods</th>
      <th>storm</th>
      <th>fire</th>
      <th>earthquake</th>
      <th>cold</th>
      <th>other_weather</th>
      <th>direct_report</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>Weather update - a cold front from Cuba that c...</td>
      <td>Un front froid se retrouve sur Cuba ce matin. ...</td>
      <td>direct</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>7</td>
      <td>Is the Hurricane over or is it not over</td>
      <td>Cyclone nan fini osinon li pa fini</td>
      <td>direct</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8</td>
      <td>Looking for someone but no name</td>
      <td>Patnm, di Maryani relem pou li banm nouvel li ...</td>
      <td>direct</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>9</td>
      <td>UN reports Leogane 80-90 destroyed. Only Hospi...</td>
      <td>UN reports Leogane 80-90 destroyed. Only Hospi...</td>
      <td>direct</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12</td>
      <td>says: west side of Haiti, rest of the country ...</td>
      <td>facade ouest d Haiti et le reste du pays aujou...</td>
      <td>direct</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 40 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="6.-Remove-duplicates.">6. Remove duplicates.<a class="anchor-link" href="#6.-Remove-duplicates."> </a></h3><ul>
<li>Check how many duplicates are in this dataset.</li>
<li>Drop the duplicates.</li>
<li>Confirm duplicates were removed.</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">n_dup_rows</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">cols</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the number of rows in `df` that are duplicates, when considering columns `cols`.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">dup_counts</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">cols</span><span class="p">)[</span><span class="s1">&#39;count&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_cols</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_cols</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[&#39;id&#39;, &#39;message&#39;, &#39;original&#39;, &#39;genre&#39;, &#39;related&#39;, &#39;request&#39;, &#39;offer&#39;, &#39;aid_related&#39;, &#39;medical_help&#39;, &#39;medical_products&#39;, &#39;search_and_rescue&#39;, &#39;security&#39;, &#39;military&#39;, &#39;child_alone&#39;, &#39;water&#39;, &#39;food&#39;, &#39;shelter&#39;, &#39;clothing&#39;, &#39;money&#39;, &#39;missing_people&#39;, &#39;refugees&#39;, &#39;death&#39;, &#39;other_aid&#39;, &#39;infrastructure_related&#39;, &#39;transport&#39;, &#39;buildings&#39;, &#39;electricity&#39;, &#39;tools&#39;, &#39;hospitals&#39;, &#39;shops&#39;, &#39;aid_centers&#39;, &#39;other_infrastructure&#39;, &#39;weather_related&#39;, &#39;floods&#39;, &#39;storm&#39;, &#39;fire&#39;, &#39;earthquake&#39;, &#39;cold&#39;, &#39;other_weather&#39;, &#39;direct_report&#39;]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n_dup_rows</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">df_cols</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>124</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n_dup_rows</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>273</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n_dup_rows</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>277</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">subset_cols</span> <span class="o">=</span> <span class="n">df_cols</span>
<span class="n">subset_cols</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">)</span>
<span class="n">subset_cols</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;original&#39;</span><span class="p">)</span>
<span class="n">subset_cols</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;genre&#39;</span><span class="p">)</span>
<span class="n">n_dup_rows</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">subset_cols</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>275</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Drop Duplicates</strong></p>
<p>The input to our classification is the 'message' column, and the 'original' column will not be used as an input to the classification. Exclude the 'original' column from the columns for consideration as duplicates so that when we drop duplicates for <code>df</code>, we will have multiple rows for a message only if the categorizations differ. (If we considered two or more rows as non-duplicate if they differed only by the 'original' column, that would amount to having multiple identical training instances, and there is no good reason for this overweighting of this instance.)</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n_dup_rows</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n_dup_rows</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">subset_cols</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>2</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dup_counts</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">subset_cols</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>message</th>
      <th>related</th>
      <th>request</th>
      <th>offer</th>
      <th>aid_related</th>
      <th>medical_help</th>
      <th>medical_products</th>
      <th>search_and_rescue</th>
      <th>security</th>
      <th>military</th>
      <th>...</th>
      <th>other_infrastructure</th>
      <th>weather_related</th>
      <th>floods</th>
      <th>storm</th>
      <th>fire</th>
      <th>earthquake</th>
      <th>cold</th>
      <th>other_weather</th>
      <th>direct_report</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>175</th>
      <td>#NAME?</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
<p>1 rows × 38 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(26216, 40)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>message</th>
      <th>original</th>
      <th>genre</th>
      <th>related</th>
      <th>request</th>
      <th>offer</th>
      <th>aid_related</th>
      <th>medical_help</th>
      <th>medical_products</th>
      <th>...</th>
      <th>aid_centers</th>
      <th>other_infrastructure</th>
      <th>weather_related</th>
      <th>floods</th>
      <th>storm</th>
      <th>fire</th>
      <th>earthquake</th>
      <th>cold</th>
      <th>other_weather</th>
      <th>direct_report</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>Weather update - a cold front from Cuba that c...</td>
      <td>Un front froid se retrouve sur Cuba ce matin. ...</td>
      <td>direct</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>7</td>
      <td>Is the Hurricane over or is it not over</td>
      <td>Cyclone nan fini osinon li pa fini</td>
      <td>direct</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8</td>
      <td>Looking for someone but no name</td>
      <td>Patnm, di Maryani relem pou li banm nouvel li ...</td>
      <td>direct</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>9</td>
      <td>UN reports Leogane 80-90 destroyed. Only Hospi...</td>
      <td>UN reports Leogane 80-90 destroyed. Only Hospi...</td>
      <td>direct</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12</td>
      <td>says: west side of Haiti, rest of the country ...</td>
      <td>facade ouest d Haiti et le reste du pays aujou...</td>
      <td>direct</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 40 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="7.-Save-the-clean-dataset-into-an-sqlite-database.">7. Save the clean dataset into an sqlite database.<a class="anchor-link" href="#7.-Save-the-clean-dataset-into-an-sqlite-database."> </a></h3><p>You can do this with pandas <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.to_sql.html"><code>to_sql</code> method</a> combined with the SQLAlchemy library. Remember to import SQLAlchemy's <code>create_engine</code> in the first cell of this notebook to use it below.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s1">&#39;sqlite:///CleanedMessages.db&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="s1">&#39;CategorizedMessages&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="s1">&#39;replace&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="8.-Use-this-notebook-to-complete-etl_pipeline.py">8. Use this notebook to complete <code>etl_pipeline.py</code><a class="anchor-link" href="#8.-Use-this-notebook-to-complete-etl_pipeline.py"> </a></h3><p>Use the template file attached in the Resources folder to write a script that runs the steps above to create a database based on new datasets specified by the user. Alternatively, you can complete <code>etl_pipeline.py</code> in the classroom on the <code>Project Workspace IDE</code> coming later.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="ETL-Script-for-Production">ETL Script for Production<a class="anchor-link" href="#ETL-Script-for-Production"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="load_data" class="doc_header"><code>load_data</code><a href="https://github.com/rickatx/message_response_pipeline/tree/master/message_response_pipeline/process_data.py#L13" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>load_data</code>(<strong><code>messages_filepath</code></strong>, <strong><code>categories_filepath</code></strong>)</p>
</blockquote>
<p>Load message and category data from the specified filepaths.</p>
<p>Args:</p>
<ul>
<li>messages_filepath (str): path to messages csv file</li>
<li>categories_filepath (str): path to categories csv file</li>
</ul>
<p>Returns:</p>
<ul>
<li>DataFrame of the two datasets, joined on 'id'.</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Example call to <code>load_data()</code>:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">loaded</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="s2">&quot;messages.csv&quot;</span><span class="p">,</span> <span class="s2">&quot;categories.csv&quot;</span><span class="p">)</span>
<span class="n">loaded</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>message</th>
      <th>original</th>
      <th>genre</th>
      <th>categories</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>Weather update - a cold front from Cuba that c...</td>
      <td>Un front froid se retrouve sur Cuba ce matin. ...</td>
      <td>direct</td>
      <td>related-1;request-0;offer-0;aid_related-0;medi...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>7</td>
      <td>Is the Hurricane over or is it not over</td>
      <td>Cyclone nan fini osinon li pa fini</td>
      <td>direct</td>
      <td>related-1;request-0;offer-0;aid_related-1;medi...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8</td>
      <td>Looking for someone but no name</td>
      <td>Patnm, di Maryani relem pou li banm nouvel li ...</td>
      <td>direct</td>
      <td>related-1;request-0;offer-0;aid_related-0;medi...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>9</td>
      <td>UN reports Leogane 80-90 destroyed. Only Hospi...</td>
      <td>UN reports Leogane 80-90 destroyed. Only Hospi...</td>
      <td>direct</td>
      <td>related-1;request-1;offer-0;aid_related-1;medi...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12</td>
      <td>says: west side of Haiti, rest of the country ...</td>
      <td>facade ouest d Haiti et le reste du pays aujou...</td>
      <td>direct</td>
      <td>related-1;request-0;offer-0;aid_related-0;medi...</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="clean_data" class="doc_header"><code>clean_data</code><a href="https://github.com/rickatx/message_response_pipeline/tree/master/message_response_pipeline/process_data.py#L29" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>clean_data</code>(<strong><code>df</code></strong>)</p>
</blockquote>
<p>Clean the loaded messages and categories data.
Convert 'categories' column string into a set of numeric columns, and remove duplicate rows.</p>
<p>Arg:</p>
<ul>
<li>df: DataFrame containing data loaded by load_data()</li>
</ul>
<p>Returns:</p>
<ul>
<li>DataFrame of cleaned data.</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Example call to <code>clean_data()</code></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cleaned</span> <span class="o">=</span> <span class="n">clean_data</span><span class="p">(</span><span class="n">loaded</span><span class="p">)</span>
<span class="n">cleaned</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>message</th>
      <th>original</th>
      <th>genre</th>
      <th>related</th>
      <th>request</th>
      <th>offer</th>
      <th>aid_related</th>
      <th>medical_help</th>
      <th>medical_products</th>
      <th>...</th>
      <th>aid_centers</th>
      <th>other_infrastructure</th>
      <th>weather_related</th>
      <th>floods</th>
      <th>storm</th>
      <th>fire</th>
      <th>earthquake</th>
      <th>cold</th>
      <th>other_weather</th>
      <th>direct_report</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>Weather update - a cold front from Cuba that c...</td>
      <td>Un front froid se retrouve sur Cuba ce matin. ...</td>
      <td>direct</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>7</td>
      <td>Is the Hurricane over or is it not over</td>
      <td>Cyclone nan fini osinon li pa fini</td>
      <td>direct</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8</td>
      <td>Looking for someone but no name</td>
      <td>Patnm, di Maryani relem pou li banm nouvel li ...</td>
      <td>direct</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>3 rows × 40 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">expected_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;message&#39;</span><span class="p">,</span> <span class="s1">&#39;original&#39;</span><span class="p">,</span> <span class="s1">&#39;genre&#39;</span><span class="p">,</span> <span class="s1">&#39;related&#39;</span><span class="p">,</span> <span class="s1">&#39;request&#39;</span><span class="p">,</span> <span class="s1">&#39;offer&#39;</span><span class="p">,</span> <span class="s1">&#39;aid_related&#39;</span><span class="p">,</span> 
                 <span class="s1">&#39;medical_help&#39;</span><span class="p">,</span> <span class="s1">&#39;medical_products&#39;</span><span class="p">,</span> <span class="s1">&#39;search_and_rescue&#39;</span><span class="p">,</span> <span class="s1">&#39;security&#39;</span><span class="p">,</span> <span class="s1">&#39;military&#39;</span><span class="p">,</span> 
                 <span class="s1">&#39;child_alone&#39;</span><span class="p">,</span> <span class="s1">&#39;water&#39;</span><span class="p">,</span> <span class="s1">&#39;food&#39;</span><span class="p">,</span> <span class="s1">&#39;shelter&#39;</span><span class="p">,</span> <span class="s1">&#39;clothing&#39;</span><span class="p">,</span> <span class="s1">&#39;money&#39;</span><span class="p">,</span> <span class="s1">&#39;missing_people&#39;</span><span class="p">,</span> 
                 <span class="s1">&#39;refugees&#39;</span><span class="p">,</span> <span class="s1">&#39;death&#39;</span><span class="p">,</span> <span class="s1">&#39;other_aid&#39;</span><span class="p">,</span> <span class="s1">&#39;infrastructure_related&#39;</span><span class="p">,</span> <span class="s1">&#39;transport&#39;</span><span class="p">,</span> <span class="s1">&#39;buildings&#39;</span><span class="p">,</span> 
                 <span class="s1">&#39;electricity&#39;</span><span class="p">,</span> <span class="s1">&#39;tools&#39;</span><span class="p">,</span> <span class="s1">&#39;hospitals&#39;</span><span class="p">,</span> <span class="s1">&#39;shops&#39;</span><span class="p">,</span> <span class="s1">&#39;aid_centers&#39;</span><span class="p">,</span> <span class="s1">&#39;other_infrastructure&#39;</span><span class="p">,</span> 
                 <span class="s1">&#39;weather_related&#39;</span><span class="p">,</span> <span class="s1">&#39;floods&#39;</span><span class="p">,</span> <span class="s1">&#39;storm&#39;</span><span class="p">,</span> <span class="s1">&#39;fire&#39;</span><span class="p">,</span> <span class="s1">&#39;earthquake&#39;</span><span class="p">,</span> <span class="s1">&#39;cold&#39;</span><span class="p">,</span> <span class="s1">&#39;other_weather&#39;</span><span class="p">,</span> 
                 <span class="s1">&#39;direct_report&#39;</span><span class="p">]</span>
<span class="k">assert</span> <span class="n">expected_cols</span> <span class="o">==</span> <span class="nb">list</span><span class="p">(</span><span class="n">cleaned</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_engine" class="doc_header"><code>get_engine</code><a href="https://github.com/rickatx/message_response_pipeline/tree/master/message_response_pipeline/process_data.py#L68" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_engine</code>(<strong><code>database_filename</code></strong>)</p>
</blockquote>
<p>Return database engine given database filename.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="save_data" class="doc_header"><code>save_data</code><a href="https://github.com/rickatx/message_response_pipeline/tree/master/message_response_pipeline/process_data.py#L72" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>save_data</code>(<strong><code>df</code></strong>, <strong><code>engine</code></strong>)</p>
</blockquote>
<p>Save the specified DataFrame as table 'CategorizedMessages' to specified database <code>engine</code>.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Example calls to <code>get_engine()</code>/<code>save_data()</code></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_df</span> <span class="o">=</span> <span class="n">cleaned</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>

<span class="c1"># save the dataframe</span>
<span class="n">engn</span> <span class="o">=</span> <span class="n">get_engine</span><span class="p">(</span><span class="s2">&quot;test_save.db&quot;</span><span class="p">)</span>
<span class="n">save_data</span><span class="p">(</span><span class="n">test_df</span><span class="p">,</span> <span class="n">engn</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>

</div>
</div>
</div>
</div>
 

